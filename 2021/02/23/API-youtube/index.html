<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>API-youtube</title><meta name="description" content="Front-end Engineer"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="
成品
觀察功能需求
搜尋框，輸入搜尋關鍵字，下方會列出5筆列表
有圖片縮圖、影片標題、影片描述


按下next page 會取得下5筆資料
按下prev page，會取得上5筆資料

ajax 在同一個頁面，不做刷新就可以改變頁面的內容。q: query
youtube API(application programming interface)資料查看YouTube 資料 API 參考手冊
取得授權：憑證

API 金鑰:AIzaSyCKPRCaNS-PQJLl2jzoQEf-O4I0tnrtd8M
jQuery API D ocument =&amp;gt; 表示看官方文件
串API =&amp;gt;檢視範例，ajax資料的情形

JS 部分1.嘗試串接Youtube API
首先需考量，我們所需要的資料參數有哪.."><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Let's Code" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Eva's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">API-youtube</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#觀察功能需求"><span class="toc-text">觀察功能需求</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#youtube-API-application-programming-interface-資料查看"><span class="toc-text">youtube API(application programming interface)資料查看</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#檢視範例，ajax資料的情形"><span class="toc-text">檢視範例，ajax資料的情形</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JS-部分"><span class="toc-text">JS 部分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-嘗試串接Youtube-API"><span class="toc-text">1.嘗試串接Youtube API</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-製作上、下頁的按鈕鍵"><span class="toc-text">3.製作上、下頁的按鈕鍵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-下一頁點下後，下五筆的資料"><span class="toc-text">4.下一頁點下後，下五筆的資料</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-上一頁"><span class="toc-text">5.上一頁</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#用瀏覽器debug"><span class="toc-text">用瀏覽器debug</span></a></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/Ajax"><i class="tag post-item-tag">Ajax</i></a><a href="/tags/API"><i class="tag post-item-tag">API</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">API-youtube</h1><time class="has-text-grey" datetime="2021-02-23T06:47:04.000Z">2021-02-23</time><article class="mt-2 post-content"><p><img src="https://i.imgur.com/HyrwBQl.png" alt=""></p>
<p><a href="https://eva813.github.io/Eva_portfolio/YoutubeAPI/YoutubeAPI.html" target="_blank" rel="noopener">成品</a></p>
<h2 id="觀察功能需求"><a href="#觀察功能需求" class="headerlink" title="觀察功能需求"></a>觀察功能需求</h2><ul>
<li>搜尋框，輸入搜尋關鍵字，下方會列出5筆列表<ul>
<li>有圖片縮圖、影片標題、影片描述</li>
</ul>
</li>
<li>按下next page 會取得下5筆資料</li>
<li>按下prev page，會取得上5筆資料</li>
</ul>
<p>ajax 在同一個頁面，不做刷新就可以改變頁面的內容。<br>q: query</p>
<h2 id="youtube-API-application-programming-interface-資料查看"><a href="#youtube-API-application-programming-interface-資料查看" class="headerlink" title="youtube API(application programming interface)資料查看"></a>youtube API(application programming interface)資料查看</h2><p><a href="https://developers.google.com/youtube/v3/docs/" target="_blank" rel="noopener">YouTube 資料 API 參考手冊</a></p>
<p>取得授權：<a href="https://console.developers.google.com/projectselector2/apis/credentials?pli=1&supportedpurview=project" target="_blank" rel="noopener">憑證</a></p>
<p><img src="https://i.imgur.com/asf7coq.png" alt=""></p>
<p>API 金鑰:AIzaSyCKPRCaNS-PQJLl2jzoQEf-O4I0tnrtd8M</p>
<pre><code>jQuery API D ocument =&gt; 表示看官方文件
串API =&gt;</code></pre><h4 id="檢視範例，ajax資料的情形"><a href="#檢視範例，ajax資料的情形" class="headerlink" title="檢視範例，ajax資料的情形"></a>檢視範例，ajax資料的情形</h4><p><img src="https://i.imgur.com/wc6VWtV.png" alt=""></p>
<p><img src="https://i.imgur.com/tSYR4vu.png" alt=""></p>
<h2 id="JS-部分"><a href="#JS-部分" class="headerlink" title="JS 部分"></a>JS 部分</h2><h3 id="1-嘗試串接Youtube-API"><a href="#1-嘗試串接Youtube-API" class="headerlink" title="1.嘗試串接Youtube API"></a>1.嘗試串接Youtube API</h3><ul>
<li><p>首先需考量，我們所需要的資料參數有哪些(</p>
</li>
<li><p>在抓取成功的部分，要設置抓取五筆搜尋到的五筆資料，並將其呈現於頁面</p>
<ul>
<li><p>除了5筆資料外，還需要跳轉上、下頁的按鈕</p>
<pre><code class="javascript">function getVideo() {
let value = $(&#39;#search-field&#39;).val();
let youtubeURL = &quot;https://www.googleapis.com/youtube/v3/search&quot;;
$.ajax({
type: &quot;GET&quot;,
url: youtubeURL,
data: {//將要放入網址的參數放在這
part:
  &#39;id,snippet&#39;,// 必填，把需要的資訊列出來
q: value,// 查詢文字
maxResults: 5,// 預設為五筆資料，可以設定1~50
type: &quot;video&quot;,
key: &#39;AIzaSyCKPRCaNS-PQJLl2jzoQEf-O4I0tnrtd8M&#39;// 使用 API 只能取得公開的播放清單

},
dataType: &quot;json&quot;,
success: function (data) {
//console.log(data);
let nextPageToken = data.nextPageToken;
let prevPageToken = data.prevPageToken;

//試著將收到的資料傳入，並呈現於畫面中
insertItems(data);

getBtn(data, prevPageToken, nextPageToken)

</code></pre>
</li>
</ul>
</li>
</ul>
<pre><code>}, error: function (err) {
  console.log(&#39;oh no&#39;);
}</code></pre><p>  });<br>}</p>
<pre><code>網址放入參數
[[JS] 使用 JavaScript 解析網址與處理網址中的參數（URL Parameters）](https://pjchender.blogspot.com/2018/08/js-javascript-url-parameters.html)

### 2.將資料呈現於頁面(insertItems())

* 透過迴圈方式將要抓取的資料依序填入
* 觀察原本畫面結構，並依據去找尋資料中符合的資料
    * videoId、videoTitle、description、channelTitle...

```javascript
function insertItems(item) {
  let output = &#39;&#39;;
  $.each(item.items, function (index, value) {
    let videoId = item.items[index].id.videoId;
    let videoTitle = item.items[index].snippet.title;
    let description = item.items[index].snippet.description;
    let thumbnailURL = item.items[index].snippet.thumbnails.high.url;//高解析度影片縮圖
    let channelTitle = item.items[index].snippet.channelTitle;
    let publishedDate = item.items[index].snippet.publishedAt;
    // 按鈕



    output += `&lt;li&gt;&lt;div class=&quot;list-left&quot;&gt;
    &lt;img src=&quot; ${thumbnailURL}&quot;&gt;&lt;/div&gt;
    &lt;div class=&quot;list-right&quot;&gt;
    &lt;h3&gt;
    &lt;a data-fancybox data-type=&quot;iframe&quot; data-src=&quot;https://www.youtube.com/embed/${videoId}&quot; &quot;href=&quot;javascript:;&quot;&gt; ${videoTitle} &lt;/a&gt;&lt;/h3&gt; &lt;small&gt;By &lt;span class=&quot;cTitle&quot;&gt; ${channelTitle}&lt;/span&gt; on ${publishedDate}&lt;/small&gt;
    &lt;p&gt; ${description} &lt;p&gt;&lt;/div&gt;&lt;/li&gt; &lt;div classs=&quot;clearfix&quot;&gt;&lt;/div&gt; 
    `

    $(&#39;#results&#39;).html(output);
  });
};</code></pre><h2 id="3-製作上、下頁的按鈕鍵"><a href="#3-製作上、下頁的按鈕鍵" class="headerlink" title="3.製作上、下頁的按鈕鍵"></a>3.製作上、下頁的按鈕鍵</h2><ul>
<li>注意該函式要帶入的參數有哪些</li>
<li>我們要判斷為，在第一頁時，只有下一頁的按鈕<ul>
<li>判斷方式為，<code>(!prevPageToken)</code>沒有上一頁的token</li>
<li>（截圖）</li>
</ul>
</li>
<li>在判斷之中，我們需要將要插入的標籤與內容，放入，並append到畫面要呈現的位置</li>
<li>注意：在插入的button之中，加入<code>data-token=&quot;${nextPageToken}&quot; data-query=&quot;${value}&quot;</code>，用於後續抓取屬性內容。</li>
</ul>
<pre><code class="javascript">function getBtn(value, prevPageToken, nextPageToken) {
  console.log(nextPageToken)
  if (!prevPageToken) {
    var btnOutput = $(`&lt;div class=&quot;button-container&quot;&gt;
    &lt;button id=&quot;next-button&quot; class=&quot;paging-button&quot; data-token=&quot;${nextPageToken}&quot; data-query=&quot;${value}&quot; onclick=&quot;pressNext();&quot;&gt; Next Page&lt;/button&gt;&lt;/div&gt;`
    )
    $(&quot;#buttons&quot;).append(btnOutput);
  } else {
    var btnOutput = $(`&lt;div class=&quot;button-container&quot;&gt;&lt;button id=&quot;prev-button&quot; class=&quot;paging-button&quot; data-token=&quot;${prevPageToken}&quot; data-query=&quot;${value}&quot; onclick=&quot;pressPrev();&quot;&gt; Prev Page&lt;/button&gt;  
    &lt;button id=&quot;next-button&quot; class=&quot;paging-button&quot;  data-token=&quot;${nextPageToken}&quot; data-query=&quot;${value}&quot; onclick=&quot;pressNext();&quot;&gt;Next Page&lt;/button&gt;&lt;/div&gt;`)
    $(&quot;#buttons&quot;).append(btnOutput);
  }

}</code></pre>
<p><a href="https://developers.google.com/youtube/v3/guides/implementation/pagination" target="_blank" rel="noopener">Youtube:Implementation: Pagination</a></p>
<h2 id="4-下一頁點下後，下五筆的資料"><a href="#4-下一頁點下後，下五筆的資料" class="headerlink" title="4.下一頁點下後，下五筆的資料"></a>4.下一頁點下後，下五筆的資料</h2><ul>
<li>同樣以ajax的方式來抓取<ul>
<li>在參數的地方我們要抓取的是，按取下一頁的token</li>
</ul>
</li>
<li>success之中所應用的函示，同樣為插入5筆的資料，以及上下頁的按鈕</li>
</ul>
<pre><code class="javascript">//取得下一頁的資料
function pressNext() {

  let youtubeURL = &quot;https://www.googleapis.com/youtube/v3/search&quot;;
  let token = $(&#39;#next-button&#39;).data(&#39;token&#39;);
  let value = $(&#39;#search-field&#39;).val();
  $.ajax({
    type: &quot;GET&quot;,
    url: youtubeURL,
    data: {//將要放入網址的參數放在這
      part:
        &#39;id,snippet&#39;,// 必填，把需要的資訊列出來
      q: value,// 查詢文字
      pageToken: token,
      maxResults: 5,// 預設為五筆資料，可以設定1~50
      type: &quot;video&quot;,

      key: &#39;AIzaSyCKPRCaNS-PQJLl2jzoQEf-O4I0tnrtd8M&#39;// 使用 API 只能取得公開的播放清單

    },
    dataType: &quot;json&quot;,
    success: function (data) {
      console.log(data);
      let nextPageToken = data.nextPageToken;
      let prevPageToken = data.prevPageToken;

      // 清空內容
      $(&#39;#results&#39;).html(&#39;&#39;);
      $(&#39;#buttons&#39;).html(&#39;&#39;);
      //試著將收到的資料傳入，並呈現於畫面中
      insertItems(data);

      getBtn(data, prevPageToken, nextPageToken)


    }, error: function (err) {
      console.log(&#39;oh no&#39;);
    }
  });

}</code></pre>
<h3 id="5-上一頁"><a href="#5-上一頁" class="headerlink" title="5.上一頁"></a>5.上一頁</h3><ul>
<li><p>同樣的抓取方式，只有要帶入的資料有些差異</p>
</li>
<li><p><code>token = $(&#39;#prev-button&#39;).data(&#39;token&#39;);</code></p>
<pre><code class="javascript">//前一頁
function pressPrev() {
// 清空內容
$(&#39;#results&#39;).html(&#39;&#39;);
$(&#39;#buttons&#39;).html(&#39;&#39;);
let youtubeURL = new URL(`https://www.googleapis.com/youtube/v3/search?`);
let token = $(&#39;#prev-button&#39;).data(&#39;token&#39;);
let value = $(&#39;#search-field&#39;).val();
$.ajax({
  type: &quot;GET&quot;,
  url: youtubeURL,
  data: {//將要放入網址的參數放在這
    part:
      &#39;id,snippet&#39;,// 必填，把需要的資訊列出來
    q: value,// 查詢文字
    pageToken: token,
    maxResults: 5,// 預設為五筆資料，可以設定1~50
    type: &quot;video&quot;,

    key: &#39;AIzaSyCKPRCaNS-PQJLl2jzoQEf-O4I0tnrtd8M&#39;// 使用 API 只能取得公開的播放清單

  },
  dataType: &quot;json&quot;,
  success: function (data) {
    console.log(data);
    let nextPageToken = data.nextPageToken;
    let prevPageToken = data.prevPageToken;

    // 清空內容
    $(&#39;#results&#39;).html(&#39;&#39;);
    $(&#39;#buttons&#39;).html(&#39;&#39;);
    //試著將收到的資料傳入，並呈現於畫面中
    insertItems(data);

    getBtn(data, prevPageToken, nextPageToken)

</code></pre>
</li>
</ul>
<pre><code>}, error: function (err) {
  console.log(&#39;oh no&#39;);
}</code></pre><p>  });</p>
<p>}</p>
<pre><code>

[HTML5 自定義屬性 data-* 和 jQuery.data 詳解
2018.06.20](https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/177833/)
[[技術分享] 什麼是 HTML 5 中的資料屬性（data-* attribute）](https://pjchender.blogspot.com/2017/01/html-5-data-attribute.html)

### 6.運用fancybox的方式彈出
* 使用fancyBox展示影片
    * [fancybox Documention](http://fancyapps.com/fancybox/3/docs/#iframe)
    * [fancybox-CDN](https://cdnjs.com/libraries/fancybox)
* 使用iframe連結欲嵌入的外部影片連結
    * iframe 是框架的一種，也稱為內置框架或內聯框架，用來在網頁內嵌入另外一個網頁
[](https://fancyapps.com/fancybox/3/docs/#iframe)

* 透過CDN方式連結fancybox套件
```javascript
&lt;!-- fancyBox --&gt;
  &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css&quot; /&gt;
  &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js&quot;&gt;&lt;/script&gt;</code></pre><ul>
<li>在我們點選該影片名稱區，插入影片id<pre><code class="javascript">&lt;h3&gt;&lt;a data-fancybox data-type=&quot;iframe&quot; data-src=&quot;https://www.youtube.com/embed/${videoId}&quot; &quot;href=&quot;javascript:;&quot;&gt; ${videoTitle} 
&lt;/a&gt;&lt;/h3&gt;</code></pre>
<pre><code class="javascript">$(&#39;[data-fancybox]&#39;).fancybox({
toolbar  : false,
smallBtn : true,
iframe : {
  preload : false
}
})</code></pre>
<a href="https://orow.github.io/2019/03/16/jQuery-youtube-search/" target="_blank" rel="noopener">[jQuery] - 練習-Youtube Search Engine</a></li>
</ul>
<hr>
<p>補充知識：<br>XMLHttpRequest(XHR):是一種規範，用來發ajax使用</p>
<p>token(令牌)：唯一的、可以認證身份或取得資料</p>
<p>GET:向伺服器發request，（伺服器會告訴我們要發伺服器的網址，我們向它請求資訊）</p>
<h4 id="用瀏覽器debug"><a href="#用瀏覽器debug" class="headerlink" title="用瀏覽器debug"></a>用瀏覽器debug</h4><p><img src="https://i.imgur.com/IlQ8Glx.png" alt=""></p>
<ul>
<li>可在watch加上要觀察的變數<br><img src="https://i.imgur.com/7RcELS4.png" alt=""></li>
</ul>
<hr>
<p>參考資料<br><a href="https://ithelp.ithome.com.tw/articles/10194007" target="_blank" rel="noopener">[30apis] Day 7 : YouTube Data API + 基礎 Fetch API</a><br><a href="https://www.c-sharpcorner.com/article/how-to-implement-youtube-video-search-using-youtube-data-api-v3-in-wordpress-web2/" target="_blank" rel="noopener">How To Implement A Youtube Video Search Using Youtube Data API V3</a><br><a href="https://hackmd.io/@c36ICNyhQE6-iTXKxoIocg/S1eYdtA1P" target="_blank" rel="noopener">Youtube Data API 使用手札</a><br><a href="https://a42033.gitbooks.io/api/content/Youtube/youtube_data_api/applicate.html" target="_blank" rel="noopener">Youtube Data API 申請</a><br><a href="https://console.cloud.google.com/iam-admin/quotas?hl=zh-tw&_ga=2.128962188.1087850229.1615615433-929425058.1615373715&orgonly=true&angularJsUrl=%2Fprojectselector%2Fiam-admin%2Fquotas%3Fhl%3Dzh-tw%26_ga%3D2.128962188.1087850229.1615615433-929425058.1615373715%26supportedpurview%3Dproject%26orgonly%3Dtrue%26folder%3Dtrue%26organizationId%3Dtrue&project=my-youtube-api-307211&folder=&organizationId=&supportedpurview=project" target="_blank" rel="noopener">配額</a></p>
<pre><code class="javascript=">{
  &quot;error&quot;: {
    &quot;code&quot;: 403,
    &quot;message&quot;: &quot;The request cannot be completed because you have exceeded your \u003ca href=\&quot;/youtube/v3/getting-started#quota\&quot;\u003equota\u003c/a\u003e.&quot;,
    &quot;errors&quot;: [
      {
        &quot;message&quot;: &quot;The request cannot be completed because you have exceeded your \u003ca href=\&quot;/youtube/v3/getting-started#quota\&quot;\u003equota\u003c/a\u003e.&quot;,
        &quot;domain&quot;: &quot;youtube.quota&quot;,
        &quot;reason&quot;: &quot;quotaExceeded&quot;
      }
    ]
  }
}</code></pre>
<hr>
<p><a href="https://stackoverflow.com/questions/31075893/im-getting-favicon-ico-error" target="_blank" rel="noopener">favicon.ico error</a></p>
<p>問題：</p>
<ul>
<li>script.js: Allow attribute will take precedence over ‘allowfullscreen’.<br><img src="https://i.imgur.com/0JiThlt.png" alt=""></li>
</ul>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021/03/05/sass-1/" title="CSS 預處理器- Sass/SCSS 基本介紹"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: CSS 預處理器- Sass/SCSS 基本介紹</span></a><a class="button is-default" href="/2021/02/23/API-weather/" title="串接API- 天氣預報"><span class="has-text-weight-semibold">Next: 串接API- 天氣預報</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/Claudia-theme-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/https://github.com/Eva813"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Eva 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>