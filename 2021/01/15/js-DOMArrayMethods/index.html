<!DOCTYPE html><html class="appearance-auto" lang="en"><head><meta charset="UTF-8"><title>JS實作- DOM Array Methods</title><meta name="description" content="Front-end Engineer"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, initial-scale=1"><!-- Google Analytics --><!-- End Google Analytics -->
<!-- Baidu Analytics --><!-- End Baidu Analytics --><link rel="icon" href="/images/favicon.png"><link rel="stylesheet" href="/style/common/bulma.css"><link rel="stylesheet" href="/style/base.css"><link rel="stylesheet" href="/style/common/helper.css"><script src="/js/common.js"></script><link rel="stylesheet" href="/style/post.css"><link rel="stylesheet" href="/style/themes/highlight-theme-light.css"><script src="/js/highlight.pack.js"></script><meta name="description" content="成品
需求觀察
使用fetch來串接API
透過左側按鈕，使用陣列的方法來實現不同事件
運用forEach()來將陣列資料呈現到畫面
運用map()計算金額的倍數
filter()篩選出符合條件的資料
sort()用來排序資料
reduce()計算陣列中資料的累加結果



使用fetch來串接資料
實作專案的資料來源https://randomuser.me/api

1.原本使用fetch

送出 Request，如果得到回應就會回傳帶有 Response 的 Promise 物件，使用 then 將回傳值傳遞下去。function getRandomUser() {
fetch(&amp;#39;https://randomuser.me/api&amp;#39;).then(response =&amp;gt;    re.."><meta name="generator" content="Hexo 4.2.0"><link rel="alternate" href="/atom.xml" title="Let's Code" type="application/atom+xml">
</head><body class="is-flex is-flex-direction-column"><header class="header-widget is-flex-shrink-0 is-hidden-mobile"><div class="container is-fullhd is-flex is-justify-content-space-between is-align-items-center is-full-height"><section class="is-hidden-mobile is-flex-shrink-0"><h2><a href="/">Eva's blog</a></h2></section><h3 class="is-hidden-mobile is-family-serif is-full-height is-flex is-align-items-center is-flex-shrink-0"><div class="is-full-height" id="postTopic"><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">JS實作- DOM Array Methods</p><p class="is-full-height is-flex-shrink-0 is-flex is-align-items-center is-justify-content-center">Click back to the top</p></div></h3><aside class="is-flex-shrink-0"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></aside></div></header><header class="is-flex header-widget is-flex-shrink-0 is-align-items-center is-justify-content-center is-hidden-tablet"><h3 class="is-inline-block"><a href="/">Home</a></h3><h3 class="is-inline-block"><a href="/archives">Archives</a></h3></header><main><main class="container is-max-widescreen content section post-page pt-4 px-4"><div class="columns is-flex-desktop is-justify-content-center is-flex-direction-row-reverse"><div class="column is-3 is-hidden-mobile"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#需求觀察"><span class="toc-text">需求觀察</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#使用fetch來串接資料"><span class="toc-text">使用fetch來串接資料</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#將物件傳入陣列"><span class="toc-text">將物件傳入陣列</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#數字轉金錢格式"><span class="toc-text">數字轉金錢格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#增加人員事件"><span class="toc-text">增加人員事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#運用map-來，建立-double-money事件"><span class="toc-text">運用map()來，建立 double money事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#運用sort來建立排名"><span class="toc-text">運用sort來建立排名</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sort"><span class="toc-text">sort()</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#filter篩選百萬以上的人員"><span class="toc-text">filter篩選百萬以上的人員</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#reduce"><span class="toc-text">reduce</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#理解完reduce-所回傳的參數資料後…"><span class="toc-text">理解完reduce()所回傳的參數資料後…</span></a></li></ol></li></ol></li></ol></div><div class="column is-9"><header class="my-4"><a href="/tags/JS"><i class="tag post-item-tag">JS</i></a><a href="/tags/Array"><i class="tag post-item-tag">Array</i></a></header><h1 class="mt-0 mb-1 is-family-serif" id="postTitle">JS實作- DOM Array Methods</h1><time class="has-text-grey" datetime="2021-01-15T14:19:25.000Z">2021-01-15</time><article class="mt-2 post-content"><p><a href="https://eva813.github.io/Eva_portfolio/ArrayMethods/arrayMethod.html" target="_blank" rel="noopener">成品</a><br><img src="https://i.imgur.com/gtaxVol.png" alt=""></p>
<h1 id="需求觀察"><a href="#需求觀察" class="headerlink" title="需求觀察"></a>需求觀察</h1><ul>
<li>使用fetch來串接API</li>
<li>透過左側按鈕，使用陣列的方法來實現不同事件<ul>
<li>運用<code>forEach()</code>來將陣列資料呈現到畫面</li>
<li>運用<code>map()</code>計算金額的倍數</li>
<li><code>filter()</code>篩選出符合條件的資料</li>
<li><code>sort()</code>用來排序資料</li>
<li><code>reduce()</code>計算陣列中資料的累加結果</li>
</ul>
</li>
</ul>
<h1 id="使用fetch來串接資料"><a href="#使用fetch來串接資料" class="headerlink" title="使用fetch來串接資料"></a>使用fetch來串接資料</h1><ul>
<li>實作專案的資料來源<code>https://randomuser.me/api</code></li>
</ul>
<p>1.原本使用<code>fetch</code></p>
<ul>
<li>送出 Request，如果得到回應就會回傳帶有 Response 的 Promise 物件，使用 then 將回傳值傳遞下去。<pre><code class="javascript">function getRandomUser() {
fetch(&#39;https://randomuser.me/api&#39;).then(response =&gt;    response.json()).then(data =&gt; data)
}
</code></pre>
</li>
</ul>
<pre><code>[JavaScript Fetch API 使用教學](https://www.oxxostudio.tw/articles/201908/js-fetch.html)

2.Fetch 搭配 async、await
* 使用async很容易：在定義function時，開頭加上 async
* 用fetch取得資料

```javascript
  async function getRandomUser() {
  const res = await fetch(&#39;https://randomuser.me/api&#39;);  //執行完後發出promise
  const data = await res.json();
  //查看取得的資料，並從中選擇要用的部分
  //console.log(data);
  const user = data.results[0];

  //創造新的使用者，並建立新的物件
  const newUser = {
    name: `${user.name.first} ${user.name.last}`,
    money: Math.floor(Math.random() * 1000000)
  };
  console.log(newUser);
  addData(newUser);
}
</code></pre><p>3.函式中的撰寫</p>
<ul>
<li>查看取得的<code>data</code><br><img src="https://i.imgur.com/TjYFhjC.png" alt=""></li>
<li>變數宣告要取用資料的哪個部分，並用以建立新物件的內容<ul>
<li><code>const user = data.results[0];</code></li>
<li><code>user.name.first</code><br><img src="https://i.imgur.com/NAmWK88.png" alt=""></li>
</ul>
</li>
</ul>
<h2 id="將物件傳入陣列"><a href="#將物件傳入陣列" class="headerlink" title="將物件傳入陣列"></a>將物件傳入陣列</h2><ul>
<li>data 為前面<pre><code class="javascript"></code></pre>
</li>
</ul>
<p>//將新建立的物件(newUser)放入陣列中<br>function addData(newObj) {<br>  //這裡的data是在最前面所宣告的 初始陣列<br>  data.push(newObj);</p>
<pre><code>//不放入參數，使用預設data</code></pre><p>  updateDOM();</p>
<p>}</p>
<pre><code>## 將傳入新物件的陣列，顯示於畫面

* 使用`forEach()`來呈現畫面的資料
    * 傳入參數為item，為新創的物件資料，內有：name,money
    * 創造新的`div`並增加class給他
    * 用`innerHTML`插入內容
    * 用 appendChild() 把上面新增的內容放入，新增的內容會依序排列在後面，不會被洗掉

```javascript
//將新創立的物件輸出呈現到畫面上(dom)
function updateDOM(provideData = data) {
  console.log(provideData);
  //清除main區域的div
  main.innerHTML = `&lt;h2&gt;&lt;strong&gt;Person&lt;/strong&gt;  Wealth&lt;/h2&gt;`;
  provideData.forEach(item =&gt; {
    const element = document.createElement(&#39;div&#39;);
    //在新div增加class
    element.classList.add(&#39;person&#39;);
    element.innerHTML = `&lt;strong&gt;${item.name}&lt;/strong&gt; ${item.money}`;
    main.appendChild(element);
  })
}</code></pre><p>注意：如果本來 HTML 某元素有既有的內容，但是又用 innerHTML 在同樣的元素上加上內容的時候，innerHTML 會把原本寫的東西覆蓋掉。</p>
<p><img src="https://i.imgur.com/xjxIGr7.png" alt=""></p>
<ul>
<li>注意參數的回傳<pre><code class="javascript">function updateDOM(provideData) {
console.log(provideData);
}
</code></pre>
</li>
</ul>
<pre><code>![](https://i.imgur.com/0O0629Q.png)
```javascript
function updateDOM(provideData = data) {
  console.log(provideData);
}</code></pre><p><img src="https://i.imgur.com/qW5Vqq9.png" alt=""></p>
<p><a href="https://ithelp.ithome.com.tw/articles/10218607" target="_blank" rel="noopener">JavaScript 初心者筆記: DOM - 如何用 JS 新增 HTML 內容</a></p>
<h2 id="數字轉金錢格式"><a href="#數字轉金錢格式" class="headerlink" title="數字轉金錢格式"></a>數字轉金錢格式</h2><p><img src="https://i.imgur.com/JKQrEyd.png" alt=""></p>
<pre><code class="javascript">//將回傳的隨機數字，轉換為金錢格式 -https://stackoverflow.com/questions/149055/how-to-format-numbers-as-currency-strings
function formatMoney(Money) {
  return &#39;$&#39; + Money.toFixed(2).replace(/\d(?=(\d{3})+\.)/g, &#39;$&amp;,&#39;);;
}
</code></pre>
<ul>
<li><code>formatMoney()</code>要放入剛剛forEach所傳入的金額，從這邊去調整數字的格式<pre><code class="javascript">element.innerHTML = `&lt;strong&gt;${item.name}&lt;/strong&gt;  ${formatMoney(item.money)}`;</code></pre>
</li>
</ul>
<p><img src="https://i.imgur.com/8DLGtgC.png" alt=""></p>
<h2 id="增加人員事件"><a href="#增加人員事件" class="headerlink" title="增加人員事件"></a>增加人員事件</h2><pre><code class="javascript">//設置點擊事件，按下add user，增加人
addUserBtn.addEventListener(&#39;click&#39;, getRandomUser);</code></pre>
<h2 id="運用map-來，建立-double-money事件"><a href="#運用map-來，建立-double-money事件" class="headerlink" title="運用map()來，建立 double money事件"></a>運用<code>map()</code>來，建立 double money事件</h2><ul>
<li><p>loop through array 就像forEach，但不同的是他會回傳東西</p>
<pre><code class="javascript">//double money 
function doubleMoney() {
data = data.map(item =&gt; {
  return { ...item }

});
console.log(data);
</code></pre>
</li>
</ul>
<p>}</p>
<pre><code>![](https://i.imgur.com/PpZ5v7v.png)

```javascript
//double money 
function doubleMoney() {
  data = data.map(item =&gt; {
    return { ...item, money: item.money * 2 }

  });
  console.log(data);

}
</code></pre><p><img src="https://i.imgur.com/joXfDXT.png" alt=""></p>
<p>呈現於畫面</p>
<pre><code class="javascript">//double money 
function doubleMoney() {
  data = data.map(item =&gt; {
    return { ...item, money: item.money * 2 }

  });
  console.log(data);
   updateDOM();
}
</code></pre>
<p><img src="https://i.imgur.com/M0R5KV4.png" alt=""></p>
<p><code>forEach()</code>: 针对每一个元素执行提供的函数(executes a provided function once for each array element)。<br><code>map()</code>: 创建一个新的数组，其中每一个元素由调用数组中的每一个元素执行提供的函数得来(creates a new array with the results of calling a provided function on every element in the calling array)。<br><a href="https://blog.fundebug.com/2018/02/05/map_vs_foreach/" target="_blank" rel="noopener">JavaScript中Map和ForEach的区别</a></p>
<h2 id="運用sort來建立排名"><a href="#運用sort來建立排名" class="headerlink" title="運用sort來建立排名"></a>運用<code>sort</code>來建立排名</h2><pre><code class="javascript">
//sortEvent
function sortEvent() {
  data = data.sort((a, b) =&gt; {
    return b.money - a.money;
  });
  //console.log(data);
  updateDOM();
}</code></pre>
<h4 id="sort"><a href="#sort" class="headerlink" title="sort()"></a><code>sort()</code></h4><p><code>sort</code>依據字串的 Unicode 編碼進行排序，會改變原本的陣列。</p>
<ul>
<li>排序進行方式：<code>sort()</code>會將所有元素轉成字串後，且以第一個字元為對象，再進行排序。</li>
<li>比較好的方式：一般會建議，還是以函式傳入參數來當排序條件會比較穩定。</li>
</ul>
<pre><code class="javascript">const arr = [5, 9, 1, 3, 2, 6];
// 以匿名函式回參數做「升序」排序
arr.sort(function(a, b) {
  return a - b; // a - b &gt; 0
});
// [1, 2, 3, 5, 6, 9]



// 如果要反過來做「降序」排序
arr.sort(function(a, b) {
  return b - a;
});
// [9, 6, 5, 3, 2, 1]
</code></pre>
<p>參考資料：<a href="https://ithelp.ithome.com.tw/articles/10225733" target="_blank" rel="noopener">JS 將陣列 Array 重新排列的 sort()</a>、<a href="https://medium.com/@leokao0726/%E6%B7%BA%E8%AB%87-js-sort-%E5%88%B0%E8%83%8C%E5%BE%8C%E6%8E%92%E5%BA%8F%E6%96%B9%E6%B3%95-1035f5b8cde8" target="_blank" rel="noopener">淺談 JS sort() 到背後排序方法</a>、<a href="https://www.scaler.com/topics/javascript-sort-an-array-of-objects/" target="_blank" rel="noopener">對對像數組進行排序</a></p>
<h2 id="filter篩選百萬以上的人員"><a href="#filter篩選百萬以上的人員" class="headerlink" title="filter篩選百萬以上的人員"></a><code>filter</code>篩選百萬以上的人員</h2><pre><code class="javascript">function filterMillionaires() {
  data = data.filter((item) =&gt; {
    return item.money &gt; 1000000;
  });

  updateDOM();

}</code></pre>
<p>PS:<code>filter()</code>的使用是回傳新陣列，原陣列不改變</p>
<h2 id="reduce"><a href="#reduce" class="headerlink" title="reduce"></a>reduce</h2><p>拆解內部參數<br>accumulator<br>用來累積回呼函式回傳值的累加器（accumulator）或 initialValue（若有提供的話，詳如下敘）。累加器是上一次呼叫後，所回傳的累加數值。<br>currentValue<br>原陣列目前所迭代處理中的元素。</p>
<ul>
<li><code>console.log(accumulator);</code></li>
</ul>
<p><img src="https://i.imgur.com/dGpG42b.png" alt=""></p>
<ul>
<li><code>console.log(currentValue);</code></li>
</ul>
<p><img src="https://i.imgur.com/P0yQK34.png" alt=""></p>
<ul>
<li>console.log(currentValue.money);</li>
</ul>
<p><img src="https://i.imgur.com/vNfFozL.png" alt=""></p>
<p><a href="https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce" target="_blank" rel="noopener">MDN</a><br><a href="https://w3c.hexschool.com/blog/a2cb755f" target="_blank" rel="noopener">JavaScript reduce 在做什麼？</a></p>
<h3 id="理解完reduce-所回傳的參數資料後…"><a href="#理解完reduce-所回傳的參數資料後…" class="headerlink" title="理解完reduce()所回傳的參數資料後…"></a>理解完<code>reduce()</code>所回傳的參數資料後…</h3><ul>
<li>讓金額加總計算<code>accumulator += currentValue.money</code></li>
</ul>
<pre><code class="javascript">//calculateMoney
function calculateMoney() {
  const reduceArr = data.reduce((accumulator, currentValue) =&gt; {
    //console.log(accumulator);
   // console.log(currentValue.money);
    return accumulator += currentValue.money;
  }, 0);


  const totalEl = document.createElement(&#39;div&#39;);
  totalEl.innerHTML = `&lt;h3&gt;Total Wealth: &lt;strong&gt; ${formatMoney(reduceArr)} &lt;/strong&gt; &lt;/h3&gt; `;
  main.appendChild(totalEl);
}
</code></pre>
</article><section class="jump-container is-flex is-justify-content-space-between my-6"><!-- em is empty placeholder--><a class="button is-default" href="/2021/01/16/js-scrollBlog/" title="JS實作- scrollBlog"><i class="iconfont icon-prev mr-2 has-text-grey"></i><span class="has-text-weight-semibold">Previous: JS實作- scrollBlog</span></a><a class="button is-default" href="/2021/01/15/js-SortableList/" title="JS實作- SortableList"><span class="has-text-weight-semibold">Next: JS實作- SortableList</span><i class="iconfont icon-next ml-2 has-text-grey"></i></a></section><article class="mt-6 comment-container"><script async repo="Haojen/Claudia-theme-blog" src="https://utteranc.es/client.js" issue-term="pathname" theme="preferred-color-scheme"></script></article></div></div></main></main><footer class="is-flex is-flex-direction-column is-align-items-center is-flex-shrink-0 is-family-serif"><section class="sns-container"><!-- Github--><a title="github" target="_blank" rel="noopener nofollow" href="//github.com/https://github.com/Eva813"><i class="iconfont icon-github"></i></a><!-- Ins--><!-- RSS--><!-- 知乎--><!-- 领英--><!-- 脸书--></section><p><span>Copyright ©</span><span> Eva 2022</span></p><div class="is-flex is-justify-content-center is-flex-wrap-wrap"><p>Powered by Hexo &verbar;&nbsp;</p><p class="is-flex is-justify-content-center"><a title="Hexo theme author" href="//github.com/haojen">Theme by Haojen&nbsp;</a></p><div style="margin-top: 2px"><a class="github-button" title="github-button" href="https://github.com/haojen/hexo-theme-Claudia" data-color-scheme="no-preference: light; light: light; dark: dark;" data-show-count="true"></a></div></div><div><span></span></div></footer><script async defer src="https://buttons.github.io/buttons.js"></script><script src="/js/post.js"></script></body></html>
